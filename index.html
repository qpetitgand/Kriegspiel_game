<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kriegspiel Engine - V.Syst√©mique</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="modal-tax" class="modal-backdrop" style="display: none;">
        <div class="modal-content">
            <h2>Cr√©er un Nouvel Imp√¥t</h2>
            <div class="control-group">
                <label for="tax-name-input">Nom de l'imp√¥t</label>
                <input type="text" id="tax-name-input" placeholder="Ex: Capitation, Taxe sur le sel...">
            </div>
            <div class="control-group">
                <label for="tax-type-select">Type d'imp√¥t</label>
                <select id="tax-type-select" onchange="toggleTaxOptions(this.value)">
                    <option value="">-- Choisir --</option>
                    <option value="direct">Imp√¥t Direct (bas√© sur le RNB)</option>
                    <option value="indirect">Imp√¥t Indirect (par Habitant)</option>
                </select>
            </div>
            <div id="tax-option-direct" style="display: none;">
                <label for="tax-rate-input">Taux de pr√©l√®vement (en %, ex: 0.5 pour 0.5%)</label>
                <input type="number" id="tax-rate-input" value="0.5" min="0" max="10" step="0.1">
            </div>
            <div id="tax-option-indirect" style="display: none;">
                <label for="tax-yield-input">Rendement par habitant (en Livres)</label>
                <input type="number" id="tax-yield-input" value="1" min="0">
            </div>
            <div class="modal-actions">
                <button onclick="promulguerImpot()">Promulguer l'Imp√¥t</button>
                <button onclick="toggleModal('modal-tax', false)" class="btn-danger">Annuler</button>
            </div>
        </div>
    </div>

    <div id="modal-build" class="modal-backdrop" style="display: none;">
        <div class="modal-content">
            <h2 id="modal-build-title">Construire</h2>
            <div class="control-group">
                <label for="build-type-select">Type de B√¢timent</label>
                <select id="build-type-select"></select>
            </div>
            <div class="control-group">
                <label for="build-quantity-input">Quantit√©</label>
                <input type="number" id="build-quantity-input" value="1" min="1" max="10">
            </div>
            <div id="modal-build-cost">Co√ªt: ...</div>
            <div class="modal-actions">
                <button onclick="lancerConstruction()">Construire</button>
                <button onclick="toggleModal('modal-build', false)" class="btn-danger">Annuler</button>
            </div>
        </div>
    </div>
    
    <div id="modal-city-manage" class="modal-backdrop" style="display: none;">
        <div class="modal-content">
            <h2 id="modal-city-title">G√©rer la Ville</h2>
            <p>Population : <span id="modal-city-pop">0</span></p>
            <div class="control-group">
                <label for="city-project-select">Projets d'Am√©lioration</label>
                <select id="city-project-select">
                    </select>
            </div>
            <div class="modal-actions">
            <button id="modal-city-manage-btn" onclick="lancerProjetUrbain()">Lancer le Projet</button>                
            <button onclick="toggleModal('modal-city-manage', false)" class="btn-danger">Fermer</button>
            </div>
        </div>
    </div>
    
    <div id="modal-officer-train" class="modal-backdrop" style="display: none;">
        <div class="modal-content">
            <h2>Former des Lieutenants</h2>
            <p>Les √âcoles Militaires forment des lieutenants pour votre pool de r√©serve. Co√ªt par officier : <strong id="officer-train-cost">1800 LT</strong>. Temps : <strong id="officer-train-time">2 ans</strong>.</p>
            <div class="control-group">
                <label for="officer-train-quantity">Quantit√© √† former</label>
                <input type="number" id="officer-train-quantity" value="10" min="1" oninput="updateOfficerTrainCost()">
            </div>
            <p id="officer-train-summary">Co√ªt total : 18 000 LT (9 000 LT/an)</p>
            <div class="modal-actions">
                <button onclick="lancerFormationOfficiers()">Lancer la Promotion</button>
                <button onclick="toggleModal('modal-officer-train', false)" class="btn-danger">Annuler</button>
            </div>
        </div>
    </div>

    <div id="modal-transfert-colonie" class="modal-backdrop" style="display: none;">
        <div class="modal-content">
            <h2 id="modal-transfert-title">Transf√©rer vers...</h2>
            
            <h4>Population de la "Campagne" (Disponible)</h4>
            <ul style="list-style: none; padding-left: 0;">
                <li>Colons: <strong id="transfert-pool-colons">0</strong></li>
                <li>Indig√®nes: <strong id="transfert-pool-indigenes">0</strong></li>
                <li>Esclaves: <strong id="transfert-pool-esclaves">0</strong></li>
            </ul>
            
            <h4>Quantit√©s √† transf√©rer VERS la ville :</h4>
            <div class="control-group">
                <label for="transfert-colons-input">Colons</label>
                <input type="number" id="transfert-colons-input" value="0" min="0">
            </div>
            <div class="control-group">
                <label for="transfert-esclaves-input">Esclaves</label>
                <input type="number" id="transfert-esclaves-input" value="0" min="0">
            </div>
            <div class="control-group">
                <label for="transfert-indigenes-input">Indig√®nes</label>
                <input type="number" id="transfert-indigenes-input" value="0" min="0">
            </div>

            <div class="modal-actions">
                <button onclick="transfererRessourcesColonie()">Transf√©rer</button>
                <button onclick="toggleModal('modal-transfert-colonie', false)" class="btn-danger">Annuler</button>
            </div>
        </div>
    </div>

    <div id="modal-army-manage" class="modal-backdrop" style="display: none;">
        <div class="modal-content" style="max-width: 700px;">
            <h2 id="modal-army-title">G√©rer l'Arm√©e</h2>
            
            <div class="stat-grid" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                <div>Localisation <strong id="modal-army-location">...</strong></div>
                <div>Statut <strong id="modal-army-status" class="neutral">...</strong></div>
                <div>R√©giments <strong id="modal-army-reg-count">0</strong></div>
                <div>Puissance <strong id="modal-army-power" class="neutral">0</strong></div>
            </div>

            <h4>Actions de Mouvement (Point 5)</h4>
            <div class="action-grid-small" style="grid-template-columns: 3fr 1fr;">
                <div class="control-group">
                    <label for="modal-army-move-select">D√©placer vers (Provinces Voisines)</label>
                    <select id="modal-army-move-select">
                        </select>
                </div>
                <button onclick="deplacerArmee()">D√©placer</button>
            </div>

            <h4>Autres Actions</h4>
            <div class="action-grid-small" style="grid-template-columns: 1fr 1fr;">
                <button onclick="changerStatutArmee()">Changer Statut (D√©fense/Invasion)</button>
                <button onclick="alert('Fonctionnalit√© de transfert √† venir.')">Transf√©rer R√©giments</button>
            </div>

            <h4>R√©giments Assign√©s</h4>
            <table class="data-table">
                <thead><tr><th>Nom</th><th>Type</th><th>Effectif</th></tr></thead>
                <tbody id="modal-army-reg-list">
                    </tbody>
            </table>
            
            <div class="modal-actions">
                <button onclick="toggleModal('modal-army-manage', false)" class="btn-danger">Fermer</button>
            </div>
        </div>
    </div>

    <div id="modal-province-info" class="modal-backdrop" style="display: none;">
        <div class="modal-content">
            <h2 id="modal-province-title">...</h2>
            
            <div class="stat-grid" style="grid-template-columns: 1fr 1fr 1fr;">
                <div>Propri√©taire <strong id="modal-province-owner">...</strong></div>
                <div>Superficie <strong id="modal-province-size">...</strong></div>
                <div>Instabilit√© <strong id="modal-province-unrest" class="neutral">...</strong></div>
            </div>

            <h4>Forteresses</h4>
            <table class="data-table-simple">
                <tbody id="modal-province-forts">
                    </tbody>
            </table>

            <h4>Arm√©es Pr√©sentes</h4>
            <ul id="modal-province-armies">
                </ul>
            
            <div class="modal-actions">
                <button onclick="toggleModal('modal-province-info', false)" class="btn-danger">Fermer</button>
            </div>
        </div>
    </div>
    
    <header>
        <div class="header-left">
            <h1>Kriegspiel Syst√©mique</h1>
            <select id="faction-selector" onchange="changerFaction(this.value)"></select>
        </div>
        <div class="header-mid">
            <div class="stat-simple">
                <span>Tr√©sor</span>
                <strong id="header-tresor" class="positive">0 LT</strong>
            </div>
            <div class="stat-simple">
                <span>Population Totale</span>
                <strong id="header-population">0</strong>
            </div>
            <div class="stat-simple">
                <span>Ann√©e</span>
                <strong id="header-annee">1 / 25</strong>
            </div>
        </div>
        <div class="header-right">
            <button onclick="prochainTour()">Prochain Tour (1 An)</button>
        </div>
    </header>

    <main>
        <div class="column-main">
            <div class="card">
                <h2>Statut Global</h2>
                <div class="stat-grid">
                    <div id="stat-confiance">Confiance Pop. <strong class="positive">100%</strong></div>
                    <div id="stat-efficacite">Efficacit√© Admin. <strong class="positive">100%</strong></div>
                    <div id="stat-moral-armee">Moral Arm√©e <strong class="positive">100%</strong></div>
                    <div id="stat-prestige">Prestige <strong class="neutral">100</strong></div>
                </div>
            </div>
            
            <div class="card" style="position: relative;">
                <h2>Carte des Op√©rations</h2>
                
                <div id="interactive-map-container">
                    <p style="text-align: center; color: #888;">Chargement de la carte des provinces...</p>
                    <img src="Carte Kriegspiel.jpg" alt="Carte Principale" style="width:100%; opacity: 0.3;">
                </div>
                
                <div id="province-tooltip" style="display: none; position: absolute; background: #fff; border: 1px solid #000; padding: 5px; border-radius: 3px; pointer-events: none; z-index: 1001;">
                    Province...
                </div>
            </div>
        </div>

        <div class="column-data">
            
            <div class="tabs">
                <button class="tab-link active" onclick="openTab(event, 'tab-budget')">üí∞ Budget & Fiscalit√©</button>
                <button class="tab-link" onclick="openTab(event, 'tab-admin')">üèõÔ∏è Administration & Villes</button>
                <button class="tab-link" onclick="openTab(event, 'tab-politique')">‚öñÔ∏è Politique & Population</button>
                <button class="tab-link" onclick="openTab(event, 'tab-population')">üßë‚Äçü§ù‚Äçüßë D√©mographie</button>
                <button class="tab-link" onclick="openTab(event, 'tab-territoire')">üó∫Ô∏è Territoire</button>
                <button class="tab-link" onclick="openTab(event, 'tab-ressources')">üå≥ Ressources & Agriculture</button>
                <button class="tab-link" onclick="openTab(event, 'tab-industrie')">üè≠ Industrie & Mines</button>
                <button class="tab-link" onclick="openTab(event, 'tab-militaire')">‚öîÔ∏è Arm√©e</button>
                <button class="tab-link" onclick="openTab(event, 'tab-operations')">üó∫Ô∏è Op√©rations Militaires</button>
                <button class="tab-link" onclick="openTab(event, 'tab-diplomatie')">üïäÔ∏è Diplomatie</button>
                <button class="tab-link" onclick="openTab(event, 'tab-marine')">üö¢ Marine</button>
                <button class="tab-link" onclick="openTab(event, 'tab-colonies')">üåç Colonies</button>
                <button class="tab-link" onclick="openTab(event, 'tab-commerce')">üìà Commerce</button>
            </div>

            <div id="tab-budget" class="tab-content" style="display: block;">
                <div class="card">
                    <h2>Finances (Calcul√©es)</h2>
                    <div class="stat-grid" id="budget-summary">
                        <div>Recettes <strong id="summary-recettes" class="positive">0 LT</strong></div>
                        <div>D√©penses <strong id="summary-depenses" class="negative">0 LT</strong></div>
                        <div>Solde Annuel <strong id="summary-solde" class="neutral">0 LT</strong></div>
                        <div>Dette Actuelle <strong id="summary-dette" class="negative">0 LT</strong></div>
                        <div id="stat-rnb">
                            RNB (Dynamique) <strong id="summary-rnb" class="neutral">0 LT</strong>
                        </div>
                        <div id="stat-vct">
                            Valeur Comm. (Dynamique) <strong id="summary-vct" class="neutral">0 LT</strong>
                        </div>
                    </div>
                    
                    <h3>Recettes (Budget Ordinaire)</h3>
                    <p>Modifiez les taux pour ajuster les recettes. Les imp√¥ts directs impactent l'efficacit√©, les indirects la confiance. Les imp√¥ts par tranche sont g√©r√©s dans l'onglet 'Politique'.</p>
                    <table class="data-table" id="revenues-table">
                        <thead><tr><th>Source de Revenu</th><th>Taux / Valeur</th><th>Montant Annuel Estim√©</th></tr></thead>
                        <tbody></tbody>
                    </table>
                    <button onclick="toggleModal('modal-tax', true)">+ Cr√©er un Nouvel Imp√¥t</button> 

                    <h3>D√©penses (Budget Ordinaire)</h3>
                    <p>Ajustez les budgets d'investissement. Les co√ªts de personnel sont calcul√©s automatiquement.</p>
                    
                    <details class="collapsible-section" open>
                        <summary><h4>Budgets d'Investissement (Sliders & Inputs)</h4></summary>
                        <div id="expenses-sliders">
                            <div class="control-group">
                                <label for="slider-sante_social">Sant√© & Social (1000000 LT)</label>
                                <input type="range" id="slider-sante_social" min="0" max="3000000" value="1000000" 
                                       oninput="updateDepenseSlider('sante_social', this.value)" 
                                       style="width: 100%;">
                            </div>
                            <div class="control-group">
                                <label for="slider-maison_dirigeant">Maison du Dirigeant (1000000 LT)</label>
                                <input type="range" id="slider-maison_dirigeant" min="0" max="3000000" value="1000000" 
                                       oninput="updateDepenseSlider('maison_dirigeant', this.value)" 
                                       style="width: 100%;">
                            </div>
                            
                            <div class="control-group">
                                <label>Budget Infrastructure de Base (Fixe)</label>
                                <input type="text" value="2 500 000 LT" disabled style="width: 100%; background: #eee;">
                                <p style="font-size: 0.9em; color: #666;"><i>(Inclut +200km routes, +2 ponts par an)</i></p>
                            </div>
                            
                            <div class="control-group">
                                <label for="input-infrastructure-supplementaire">Construction d'Infrastructure (Suppl√©mentaire)</label>
                                <input type="number" id="input-infrastructure-supplementaire" value="0" onchange="updateDepenseInput('infrastructure_supplementaire', this.value)" style="width: 100%;">
                            </div>
                            </div>
                    </details>
                    
                    <details class="collapsible-section" open>
                        <summary><h4>D√©penses de l'√âtat (Calcul√©es)</h4></summary>
                        <table class="data-table-simple">
                            <tbody id="budget-summary-depenses">
                                <tr><td>D√©penses de l'Arm√©e de Terre</td><td>... LT</td></tr>
                                <tr><td>D√©penses de la Marine</td><td>... LT</td></tr>
                                <tr><td>D√©penses d'Administration</td><td>... LT</td></tr>
                                <tr><td>D√©penses de Police (Gendarmerie)</td><td>... LT</td></tr>
                                <tr><td>D√©penses des Percepteurs</td><td>... LT</td></tr>
                                <tr><td>D√©penses des Services (Poste)</td><td>... LT</td></tr>
                                <tr><td>D√©penses des Pensions</td><td>... LT</td></tr>
                                <tr><td>D√©penses d'√âducation (Fixe)</td><td>... LT</td></tr>
                                <tr><td>Entretien Infrastructures (Fixe)</td><td>... LT</td></tr>
                                <tr><td>Charge de la Dette</td><td>... LT</td></tr>
                            </tbody>
                        </table>
                    </details>

                    <div class="action-grid-small" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                            
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.universite">
                                <button onclick="construireBatimentSimple('universite')">Construire Universit√©</button>
                            </div>
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.lycee">
                                <button onclick="construireBatimentSimple('lycee')">Construire Lyc√©e</button>
                            </div>
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.ecole_primaire">
                                <button onclick="construireBatimentSimple('ecole_primaire')">Construire 10 √âcoles Primaires</button>
                            </div>
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.hopital_civil">
                                <button onclick="construireBatimentSimple('hopital_civil')">Construire H√¥pital Civil</button>
                            </div>
                            
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.bureau_censure_royale">
                                <button onclick="construireBatimentSimple('bureau_censure_royale')">Bureau de la Censure</button>
                            </div>
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.institut_statistique">
                                <button onclick="construireBatimentSimple('institut_statistique')">Institut de Statistique</button>
                            </div>
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.hotel_des_monnaies">
                                <button onclick="construireBatimentSimple('hotel_des_monnaies')">H√¥tel des Monnaies</button>
                            </div>
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.caserne_veterans">
                                <button onclick="construireBatimentSimple('caserne_veterans')">Caserne de V√©t√©rans</button>
                            </div>
                        </div>
                    </div>
            </div>

            <div id="tab-admin" class="tab-content">
                <div class="card">
                    <h2>Administration, Villes & √âducation</h2>
                    <p>G√©rez l'efficacit√© de votre √âtat, le d√©veloppement de vos villes et la formation de votre √©lite.</p>

                    <div class="stat-grid" id="admin-summary-stats">
                        <div id="stat-admin-efficacite">Efficacit√© Admin <strong class="neutral">70% / 80%</strong></div>
                        <div id="stat-admin-total">Administrateurs <strong class="neutral">5 000</strong></div>
                        <div id="stat-admin-officiers">Lieutenants (Pool) <strong class="positive">...</strong></div>
                        <div id="stat-admin-infra">Infrastructures <strong class="neutral" style="font-size: 0.9em;">...</strong></div>
                    </div>

                    <details class="collapsible-section" open>
                        <summary><h3>Salaires & D√©penses de Personnel</h3></summary>
                        
                        <h4>Salaires de l'Arm√©e de Terre</h4>
                        <div class="action-grid-small" style="grid-template-columns: 1fr 1fr;">
                            <div class="control-group">
                                <label for="salaire-input-soldat">Salaire Annuel Soldat (Ligne)</label>
                                <input type="number" id="salaire-input-soldat" value="100" onchange="updateSalaireInput('soldat', this.value)">
                            </div>
                            <div class="control-group">
                                <label for="salaire-input-sous_officier">Salaire Annuel S-Officier (Ligne)</label>
                                <input type="number" id="salaire-input-sous_officier" value="200" onchange="updateSalaireInput('sous_officier', this.value)">
                            </div>
                        </div>
                        <p>Les salaires des officiers sup√©rieurs (G√©n√©raux, Colonels...) et les modificateurs (Garde, Cavalerie...) sont g√©r√©s dans l'onglet <b>Arm√©e -> Doctrine</b>.</p>

                        <h4>Salaires de la Marine</h4>
                        <div class="control-group">
                            <label for="salaire-input-marin_base">Salaire Annuel Marin (Base)</label>
                            <input type="number" id="salaire-input-marin_base" value="140" onchange="updateSalaireInput('marin_base', this.value)">
                        </div>
                        <table class="data-table">
                            <thead><tr><th>Rang (Officier Marine)</th><th>Salaire Annuel (LT)</th></tr></thead>
                            <tbody id="navy-salary-table">
                                </tbody>
                        </table>
                        
                        <h4>Gestion des Services Publics (par Ratio)</h4>
                        <p>D√©finissez le ratio d'agents par habitant. Un ratio plus bas (ex: 1/500) co√ªte plus cher mais augmente l'efficacit√©.</p>
                        
                        <div class="control-group">
                            <label for="slider-ratio-police">Police (1 Gendarme / <span id="ratio-police-display">1500</span> hab.)</label>
                            <input type="range" id="slider-ratio-police" min="500" max="5000" value="1500" step="50"
                                   oninput="updateRatioSlider('police', this.value)">
                            <p>Affecte la <b>Stabilit√©</b>. Co√ªt annuel: <strong id="cout-ratio-police">...</strong> LT</p>
                        </div>
                        <div class="control-group">
                            <label for="slider-ratio-percepteurs">Fiscalit√© (1 Percepteur / <span id="ratio-percepteurs-display">1000</span> hab.)</label>
                            <input type="range" id="slider-ratio-percepteurs" min="500" max="5000" value="1000" step="50"
                                   oninput="updateRatioSlider('percepteurs', this.value)">
                            <p>Affecte le <b>Rendement des Imp√¥ts</b> et du <b>Domaine</b>. Co√ªt annuel: <strong id="cout-ratio-percepteurs">...</strong> LT</p>
                        </div>
                        <div class="control-group">
                            <label for="slider-ratio-poste">Services (1 Postier / <span id="ratio-poste-display">2000</span> hab.)</label>
                            <input type="range" id="slider-ratio-poste" min="500" max="10000" value="2000" step="100"
                                   oninput="updateRatioSlider('poste', this.value)">
                            <p>Affecte l'<b>Efficacit√© Admin</b>. Co√ªt annuel: <strong id="cout-ratio-poste">...</strong> LT</p>
                        </div>
                        
                        <h4>D√©penses Fixes</h4>
                        <div class="control-group">
                            <label for="slider-budget-pensions">Budget Pensions (100%)</label>
                            <input type="range" id="slider-budget-pensions" min="50" max="200" value="100" 
                                   oninput="updateBudgetSlider('pensions', this.value)">
                        </div>
                    </details>
                    
                    <details class="collapsible-section">
                        <summary><h3>√âducation, Sant√© & B√¢timents Nationaux (<span id="edu-count">0</span> B√¢timents)</h3></summary>
                        <p>Construisez des √©coles pour augmenter votre plafond d'efficacit√© et former des officiers.</p>
                        
                        <div class="action-grid-small" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.universite">
                                <button onclick="construireBatimentSimple('universite')">Construire Universit√©</button>
                            </div>
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.lycee">
                                <button onclick="construireBatimentSimple('lycee')">Construire Lyc√©e</button>
                            </div>
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.ecole_primaire">
                                <button onclick="construireBatimentSimple('ecole_primaire')">Construire 10 √âcoles Primaires</button>
                            </div>
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.hopital_civil">
                                <button onclick="construireBatimentSimple('hopital_civil')">Construire H√¥pital Civil</button>
                            </div>
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.bureau_censure_royale">
                                <button onclick="construireBatimentSimple('bureau_censure_royale')">Bureau de la Censure</button>
                            </div>
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.institut_statistique">
                                <button onclick="construireBatimentSimple('institut_statistique')">Institut de Statistique</button>
                            </div>
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.hotel_des_monnaies">
                                <button onclick="construireBatimentSimple('hotel_des_monnaies')">H√¥tel des Monnaies</button>
                            </div>
                            <div class="tooltip-container" data-tooltip-def="batiments_speciaux.caserne_veterans">
                                <button onclick="construireBatimentSimple('caserne_veterans')">Caserne de V√©t√©rans</button>
                            </div>
                        </div>
                        <h4>Formation de Lieutenants</h4>
                        <button onclick="toggleModal('modal-officer-train', true)">Former une Promotion</button>
                        <table class="data-table">
                            <thead><tr><th>Promotion</th><th>Quantit√©</th><th>Temps Restant</th></tr></thead>
                            <tbody id="officer-queue-table"></tbody>
                        </table>
                    </details>

                    <details class="collapsible-section" open>
                        <summary><h3>Gestion des Villes (M√©tropole)</h3></summary>
                        <p>G√©rez vos centres urbains. Chaque b√¢timent ajoute des administrateurs et augmente votre facture salariale.</p>
                        <button onclick="fonderVilleMetropole()">Fonder une Nouvelle Ville</button>
                        
                        <details class="collapsible-section-simple" open>
                            <summary><h4>Grandes Villes (<span id="city-count-g">0</span>)</h4></summary>
                            <table class="data-table">
                                <thead><tr><th>Nom</th><th>Type</th><th>Population (est.)</th><th>Actions</th></tr></thead>
                                <tbody id="city-list-table-g"></tbody>
                            </table>
                        </details>
                        
                        <details class="collapsible-section-simple">
                            <summary><h4>Villes Moyennes (<span id="city-count-m">0</span>)</h4></summary>
                            <table class="data-table">
                                <thead><tr><th>Nom</th><th>Type</th><th>Population (est.)</th><th>Actions</th></tr></thead>
                                <tbody id="city-list-table-m"></tbody>
                            </table>
                        </details>
                        
                        <details class="collapsible-section-simple">
                            <summary><h4>Petites Villes (<span id="city-count-p">0</span>)</h4></summary>
                            <table class="data-table">
                                <thead><tr><th>Nom</th><th>Type</th><th>Population (est.)</th><th>Actions</th></tr></thead>
                                <tbody id="city-list-table-p"></tbody>
                            </table>
                        </details>
                    </details>
                    
                    <details class="collapsible-section" open>
                        <summary><h3>Infrastructures Nationales</h3></summary>
                        <p>Construisez des routes, ponts et canaux pour am√©liorer votre √©conomie. Le co√ªt est pay√© directement par le Tr√©sor. Le budget d'entretien et de construction de base (200km routes, 2 ponts) est g√©r√© automatiquement.</p>
                        <div class="action-grid-small" style="grid-template-columns: 2fr 1fr;">
                            <div class="control-group">
                                <label for="projet-simple-select">Projet √† construire</label>
                                <select id="projet-simple-select">
                                    </select>
                            </div>
                            <button onclick="construireProjetSimple()">Construire</button>
                        </div>
                    </details>
                </div>
            </div>

            <div id="tab-politique" class="tab-content">
                <div class="card">
                    <h2>Politique Int√©rieure & Population</h2>
                    
                    <details class="collapsible-section" open>
                        <summary><h3>Tranches de Revenus</h3></summary>
                        <p>Ajustez le taux d'imposition pour chaque tranche de la population. Des taux √©lev√©s peuvent provoquer des effets n√©gatifs.</p>
                        <table class="data-table">
                            <thead><tr><th>Tranche</th><th>Population (est.)</th><th>Taux d'Imposition</th><th>Effets Actuels</th></tr></thead>
                            <tbody>
                                <tr>
                                    <td>Hauts Revenus</td>
                                    <td id="tranche-haut-pop">...</td>
                                    <td><input type="number" id="tranche-haut-tax" value="20" min="0" max="70" onchange="updateTaxTranche('haut', this.value)"> %</td>
                                    <td id="tranche-haut-effets">...</td>
                                </tr>
                                <tr>
                                    <td>Revenus Moyens</td>
                                    <td id="tranche-moyen-pop">...</td>
                                    <td><input type="number" id="tranche-moyen-tax" value="15" min="0" max="50" onchange="updateTaxTranche('moyen', this.value)"> %</td>
                                    <td id="tranche-moyen-effets">...</td>
                                </tr>
                                <tr>
                                    <td>Bas Revenus</td>
                                    <td id="tranche-bas-pop">...</td>
                                    <td><input type="number" id="tranche-bas-tax" value="5" min="0" max="30" onchange="updateTaxTranche('bas', this.value)"> %</td>
                                    <td id="tranche-bas-effets">...</td>
                                </tr>
                            </tbody>
                        </table>
                    </details>

                    <details class="collapsible-section" open>
                        <summary><h3>Population Active (M√©tropole)</h3></summary>
                        <div class="stat-grid" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                            <div>Population Totale <strong id="pool-pop-totale">...</strong></div>
                            <div>Ouvriers/Admin/Arm√©e (Assign√©s) <strong id="pool-pop-assignee">...</strong></div>
                            <div>Population Non-Assign√©e (Paysans, etc.) <strong id="pool-pop-non-assignee" class="neutral">...</strong></div>
                            <div><b>Pool Main d'≈ìuvre (Disponible)</b> <strong id="pool-pop-disponible" class="positive">...</strong></div>
                        </div>
                        <p>Votre <b>Pool de Main d'≈ìuvre</b> (le 1/140e "Industriel") est la population disponible pour le recrutement d'ouvriers. La <b>Population Non-Assign√©e</b> repr√©sente les paysans, enfants, etc. Le recrutement militaire utilise son propre pool (voir onglet ‚öîÔ∏è Arm√©e).</p>
                    </details>
                    
                    <details class="collapsible-section" open>
                        <summary><h3>Gouvernement & Ministres</h3></summary>
                        <p>Nommez vos ministres. Le nombre de postes que vous pouvez pourvoir est d√©fini par votre nombre de ministres. Un m√™me individu ne peut occuper qu'un seul poste.</p>
                        
                        <div class="action-grid-small" style="grid-template-columns: 1fr 1fr 1fr;">
                            <div class="control-group">
                                <label for="ministres-nombre-input">Nombre de Ministres</label>
                                <input type="number" id="ministres-nombre-input" value="7" min="1" max="7" onchange="updateNombreMinistres(this.value)">
                            </div>
                            <div class="control-group">
                                <label>Postes Pourvus</label>
                                <strong id="ministres-focus-dispo" class="neutral" style="font-size: 1.2em; display: block; padding-top: 8px;">0 / 7</strong>
                            </div>
                        </div>
                        
                        <h4>Cabinet Minist√©riel</h4>
                        <div id="ministeres-container">
                            <div class="control-group ministere-slot">
                                <label>Ministre de la Guerre</label>
                                <select id="select_ministre_guerre" onchange="sauvegarderMinistres()"></select>
                            </div>
                            <div class="control-group ministere-slot">
                                <label>Ministre de la Marine</label>
                                <select id="select_ministre_marine" onchange="sauvegarderMinistres()"></select>
                            </div>
                            <div class="control-group ministere-slot">
                                <label>Ministre de l'Int√©rieur</label>
                                <select id="select_ministre_interieur" onchange="sauvegarderMinistres()"></select>
                            </div>
                            <div class="control-group ministere-slot">
                                <label>Ministre des Finances</label>
                                <select id="select_ministre_finances" onchange="sauvegarderMinistres()"></select>
                            </div>
                            <div class="control-group ministere-slot">
                                <label>Ministre du Commerce</label>
                                <select id="select_ministre_commerce" onchange="sauvegarderMinistres()"></select>
                            </div>
                            <div class="control-group ministere-slot">
                                <label>Ministre des Colonies</label>
                                <select id="select_ministre_colonies" onchange="sauvegarderMinistres()"></select>
                            </div>
                            <div class="control-group ministere-slot">
                                <label>Ministre de l'Administration (Justice & √âducation)</label>
                                <select id="select_ministre_administration" onchange="sauvegarderMinistres()"></select>
                            </div>
                        </div>
                    </details>
                        <p id="ministres-alerte-doublon" style="color: red; display: none;"><b>Attention :</b> Un ministre ne peut pas occuper deux postes ! Le dernier choix sera ignor√© au prochain tour.</p>
                    </details>
                    </div>
            </div>
            
            <div id="tab-population" class="tab-content">
                <div class="card">
                    <h2>D√©mographie</h2>
                    
                    <h3>D√©mographie de l'Empire</h3>
                    <div class="stat-grid" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                        <div>Population Totale <strong id="pop-total-empire">0</strong></div>
                        <div>M√©tropole <strong id="pop-total-metropole">0</strong></div>
                        <div>Colons Blancs <strong id="pop-total-colons" class="positive">0</strong></div>
                        <div>Population Coloniale <strong id="pop-total-colonies" class="neutral">0</strong></div>
                    </div>

                    <h3>D√©mographie (M√©tropole)</h3>
                    <div class="stat-grid" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                        <div>Naissances (est. /an) <strong id="pop-naissances" class="positive">0</strong></div>
                        <div>D√©c√®s (est. /an) <strong id="pop-deces" class="negative">0</strong></div>
                        <div>Croissance Nette (est. /an) <strong id="pop-nette" class="neutral">0</strong></div>
                    </div>
                    
                    </div>
            </div>
            
            <div id="tab-territoire" class="tab-content">
                <div class="card">
                    <h2>Superficie & Territoire</h2>
                    
                    <details class="collapsible-section" open>
                        <summary><h3>M√©tropole</h3></summary>
                        <div class="stat-grid" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                            <div>Superficie Totale <strong id="terr-superficie-km2">0 km¬≤</strong></div>
                            <div>Densit√© <strong id="terr-densite">0 hab/km¬≤</strong></div>
                            <div>Superficie Agricole <strong id="terr-agricole-ha">0 ha</strong></div>
                            <div>Superficie For√™t <strong id="terr-foret-ha">0 ha</strong></div>
                        </div>
                    </details>
                    
                    <details class="collapsible-section" open>
                        <summary><h3>Colonies</h3></summary>
                        <div class="stat-grid" style="grid-template-columns: 1fr 1fr 1fr;">
                            <div>Superficie Totale D√©couverte <strong id="terr-col-total-km2">0 km¬≤</strong></div>
                            <div>Superficie Cultiv√©e <strong id="terr-col-cultives-km2">0 km¬≤</strong></div>
                            <div>Terres Disponibles <strong id="terr-col-dispo-km2">0 km¬≤</strong></div>
                        </div>
                    </details>
                </div>
            </div>

            <div id="tab-ressources" class="tab-content">
                <div class="card">
                    <h2>Ressources Naturelles & Agriculture</h2>
                    <p>G√©rez l'exploitation durable de vos terres et for√™ts.</p>
                    
                    <details class="collapsible-section" open>
                        <summary><h3>Gestion Foresti√®re</h3></summary>
                        <div class="stat-grid" style="grid-template-columns: 1fr 1fr;">
                            <div>For√™t Totale <strong id="admin-foret-total">0 ha</strong></div>
                            <div>Stock de Bois <strong id="admin-stock-bois">0 m¬≥</strong></div>
                        </div>
                        <div class="control-group">
                            <label for="slider-foret">Taux d'exploitation (100% = durable)</label>
                            <input type="range" id="slider-foret" min="0" max="200" value="100" 
                                   oninput="updateExploitationSlider('taux_exploitation_bois', this.value)">
                        </div>
                        <button onclick="planterForet()">Planter 200ha de For√™t (10 000 LT)</button>
                    </details>
                    
                    <details class="collapsible-section" open>
                        <summary><h3>Agriculture (Total: <span id="admin-agriculture-total">0</span> ha)</h3></summary>
                        <p>La production agricole est bas√©e sur la superficie et la fertilit√©. Elle produit le RNB de base et nourrit votre population.</p>
                        <table class="data-table">
                            <thead><tr><th>Culture</th><th>Hectares Allou√©s</th><th>Production /an</th><th>Valeur</th></tr></thead>
                            <tbody id="admin-agriculture-table"></tbody>
                        </table>
                    </details>

                    <details class="collapsible-section">
                        <summary><h3>D√©veloppement Agricole (M√©tropole)</h3></summary>
                        <p>Augmentez votre production agricole en d√©frichant des for√™ts ou en d√©ployant de nouvelles machines.</p>
                        
                        <h4>Terres</h4>
                        <button onclick="defricherTerre()">D√©fricher 1 000 ha de For√™t (100 000 LT)</button>
                        <p style="font-size: 0.9em;"><i>Co√ªte 100 000 LT et retire 1 000 ha √† vos for√™ts pour les convertir en terres agricoles.</i></p>

                        <h4>Technologie</h4>
                        <div class="action-grid-small">
                            <div class="control-group">
                                <label>Machines en Stock</label>
                                <strong id="stock-machines-agri" class="neutral" style="font-size: 1.2em;">0</strong>
                            </div>
                            <button onclick="deployerMachineAgricole('batteuse')">D√©ployer 1 Batteuse</button>
                            <button onclick="deployerMachineAgricole('outils')">D√©ployer 1 Outil</button>
                        </div>
                        <p style="font-size: 0.9em;"><i>Consomme 1 machine du stock. Augmente le rendement des cultures de fa√ßon permanente.</i></p>
                    </details>
                </div>
            </div>

            <div id="tab-industrie" class="tab-content">
                <div class="card">
                    <h2>Industrie, Mines & Manufactures</h2>
                    <p>Transformez vos mati√®res premi√®res en biens et en √©quipement militaire.</p>

                    <details class="collapsible-section" open>
                        <summary><h3>Mati√®res Premi√®res (Stocks)</h3></summary>
                        <div class="stat-grid" style="grid-template-columns: 1fr 1fr 1fr;">
                            <div>Stock Fer <strong id="stock-fer-total">0 T</strong></div>
                            <div>Stock Cuivre <strong id="stock-cuivre-total">0 Q</strong></div>
                            <div>Stock Poudre <strong id="stock-poudre-total">0 T</strong></div>
                            <div>Stock Charbon <strong id="stock-charbon-total">0 T</strong></div>
                            <div>Machines Agri. <strong id="stock-machines-agri-total" class="neutral">0</strong></div>
                            <div>Moteurs Vapeur <strong id="stock-moteurs-vapeur-total" class="neutral">0</strong></div>
                            <div>Stock Canons (Terre) <strong id="stock-canons-terre-total" class="neutral">0</strong></div>
                            <div>Stock Canons (Mer) <strong id="stock-canons-mer-total" class="neutral">0</strong></div>
                        </div>
                    </details>
                    
                    <details class="collapsible-section">
                        <summary><h3>Mines & Production Brute</h3></summary>
                        <button onclick="ouvrirModalConstruction('mine')">Construire/Agrandir Mine</button>
                        <table class="data-table">
                            <thead><tr><th>Nom</th><th>Production Annuelle</th><th>Ouvriers</th><th>Actions</th></tr></thead>
                            <tbody id="mine-table"></tbody>
                        </table>
                    </details>
                    
                    <details class="collapsible-section">
                        <summary><h3>Haras Royaux (<span id="haras-count">0</span>)</h3></summary>
                        <p>√âlevez des chevaux pour votre cavalerie, artillerie, officiers et services civils.</p>
                        <button onclick="construireBatimentSimple('haras_royal')">Construire Haras Royal (400k LT)</button>
                        <table class="data-table">
                            <thead><tr><th>B√¢timent</th><th>Nombre</th><th>Production /an</th><th>Entretien /an</th></tr></thead>
                            <tbody id="haras-table">
                                </tbody>
                        </table>
                    </details>
                    <details class="collapsible-section">
                        <summary><h3>Manufactures Militaires (<span id="manufacture-count">0</span>)</h3></summary>
                        <button onclick="ouvrirModalConstruction('militaire')">Construire Manufacture d'Armes</button>
                        <table class="data-table">
                            <thead><tr><th>Nom</th><th>Production Annuelle</th><th>Ouvriers</th><th>Actions</th></tr></thead>
                            <tbody id="manufacture-table"></tbody>
                        </table>
                    </details>

                    <details class="collapsible-section">
                        <summary><h3>Manufactures Civiles (<span id="admin-manufactures-civiles-nb">0</span>)</h3></summary>
                        <button onclick="ouvrirModalConstruction('civile')">Construire Manufacture Civile</button>
                        <table class="data-table">
                            <thead><tr><th>Nom</th><th>Ouvriers</th><th>Bonus RNB /an</th><th>Actions</th></tr></thead>
                            <tbody id="admin-manufactures-civiles-table">
                                </tbody>
                        </table>
                    </details>
                    
                    <details class="collapsible-section">
                        <summary><h3>Industries Avanc√©es & Luxe</h3></summary>
                        <div class="action-grid-small">
                            <button onclick="ouvrirModalConstruction('avancee')">Construire Manufacture Avanc√©e</button>
                            <button onclick="ouvrirModalConstruction('luxe')">Construire Manufacture de Luxe</button>
                        </div>
                        <table class="data-table">
                            <thead><tr><th>Nom</th><th>Type</th><th>Production /an</th><th>Ouvriers</th></tr></thead>
                            <tbody id="advanced-industry-table"></tbody>
                        </table>
                    </details>
                    
                    <details class="collapsible-section">
                        <summary><h3>Finance</h3></summary>
                        <button onclick="ouvrirModalConstruction('banque')">Fonder une Banque</button>
                        <table class="data-table">
                            <thead><tr><th>Nom</th><th>Type</th><th>Bonus RNB /an</th><th>Ouvriers</th></tr></thead>
                            <tbody id="finance-table"></tbody>
                        </table>
                    </details>
                </div>
            </div>

            <div id="tab-militaire" class="tab-content">
                <div class="card">
                    <h2>Statut de l'Arm√©e de Terre</h2>
                    <div class="stat-grid" id="army-summary">
                        <div>Infanterie <strong id="summary-armee-inf">0</strong></div>
                        <div>Cavalerie <strong id="summary-armee-cav">0</strong></div>
                        <div>Artillerie <strong id="summary-armee-art">0</strong></div>
                        <div>G√©nie <strong id="summary-armee-genie">0</strong></div>
                        <div>Garde <strong id="summary-armee-garde">0</strong></div>
                        <div>R√©serve Recrutable <strong id="summary-armee-reserve">0</strong></div>
                        <div>Chevaux (Dispo/Besoin) <strong id="summary-armee-chevaux">0</strong></div>
                        <div>Stock Fusils <strong id="summary-armee-fusils" class="neutral">0</strong></div>
                        <div>Stock Canons (Terre) <strong id="summary-armee-canons-terre" class="neutral">0</strong></div>
                        <div>Stock Canons (Mer) <strong id="summary-armee-canons-mer" class="neutral">0</strong></div>
                    </div>
                    
                    <details class="collapsible-section" open>
                        <summary><h4>D√©tail des Co√ªts de l'Arm√©e de Terre</h4></summary>
                        
                        <h5>Salaires (Calcul√©s)</h5>
                        <table class="data-table-simple">
                            <tbody>
                                <tr><td>Soldats & Garde Nationale</td><td id="mil-cout-soldats">... LT</td></tr>
                                <tr><td>Sous-Officiers</td><td id="mil-cout-sous_officiers">... LT</td></tr>
                                <tr><td>Officiers (Total)</td><td id="mil-cout-officiers">... LT</td></tr>
                            </tbody>
                        </table>

                        <h5>Co√ªts Op√©rationnels (Calcul√©s)</h5>
                        <table class="data-table-simple">
                            <tbody>
                                <tr><td>Administration de l'Arm√©e (Commis)</td><td id="mil-detail-admin">... LT</td></tr>
                                <tr><td>Entretien (Rations)</td><td id="mil-detail-rations">... LT</td></tr>
                                <tr><td>Entretien (Uniformes)</td><td id="mil-detail-uniformes">... LT</td></tr>
                                <tr><td>Entretien (Entra√Ænement)</td><td id="mil-detail-entrainement">... LT</td></tr>
                                <tr><td>Entretien (Artillerie & Attirail)</td><td id="mil-detail-artillerie">... LT</td></tr>
                                <tr><td>Entretien (Armement L√©ger)</td><td id="mil-detail-fusils">... LT</td></tr>
                                <tr><td>Entretien Places & Casernes</td><td id="mil-detail-forteresses">... LT</td></tr>
                                <tr><td>Entretien Haras Royaux</td><td id="mil-detail-haras">... LT</td></tr>
                            </tbody>
                        </table>
                    </details>
                    
                    <h3>Constitution des Forces</h3>
                    <div class="action-grid-small">
                        <div class="control-group">
                            <label>Type d'unit√©</label>
                            <select id="unit-type-select"></select>
                        </div>
                        <div class="control-group">
                            <label>Quantit√©</label>
                            <input type="number" id="unit-quantity-input" value="1" min="1">
                        </div>
                        <button onclick="constituerArmees()">Recruter Unit√©s</button>
                    </div>
                    <div class="action-grid-small">
                        <div class="control-group">
                            <label>Acheter Chevaux</label>
                            <input type="number" id="horses-buy-input" value="1000" min="0" step="100">
                        </div>
                        <button onclick="acheterChevaux()">Acheter Chevaux</button>
                        <div class="control-group">
                            <label>Acheter Fusils (Stock)</label>
                            <input type="number" id="fusils-buy-input" value="1000" min="0" step="100">
                        </div>
                        <button onclick="acheterFusils()">Acheter Fusils</button>
                    </div>

                    <details class="collapsible-section" open>
                        <summary><h3>Structure de Commandement (Officiers)</h3></summary>
                        <p>Salaires de base g√©r√©s dans l'onglet Administration. Lieutenants form√©s via les √âcoles Militaires.</p>
                        <div class="stat-grid" id="officer-hierarchy-stats" style="grid-template-columns: 1fr 1fr 1fr;">
                            </div>
                    </details>

                        <div class="stat-grid" id="officer-hierarchy-stats" style="grid-template-columns: 1fr 1fr 1fr;">
                        </div>

                        <h4>Promotions & Nominations</h4>
                        <p>D√©pensez du tr√©sor et des officiers de rang inf√©rieur pour combler les postes vacants.</p>
                        <div class="action-grid-small" style="grid-template-columns: 1fr 1fr 1fr;">
                            <button onclick="promouvoirOfficiers('lieutenant', 'capitaine')">Promouvoir 10 Lieutenants (50k LT)</button>
                            <button onclick="promouvoirOfficiers('capitaine', 'lieutenant_colonel')">Promouvoir 5 Capitaines (100k LT)</button>
                            <button onclick="promouvoirOfficiers('lieutenant_colonel', 'colonel')">Promouvoir 2 Ltn-Colonels (200k LT)</button>
                            <button onclick="nommerGeneral('general_brigade')">Nommer 1 G√©n. de Brigade (500k LT)</button>
                            <button onclick="nommerGeneral('general_division')">Nommer 1 G√©n. de Division (1M LT)</button>
                        </div>
                        </details>

                    <details class="collapsible-section">
                        <summary><h3>Forteresses (<span id="fortress-count">0</span>)</h3></summary>
                        <button onclick="ouvrirModalConstruction('forteresse')">Construire Forteresse</button>
                        <button onclick="construireBatimentSimple('hopital_militaire')">Construire H√¥pital Militaire</button> <table class="data-table">
                            <thead><tr><th>Type</th><th>Nombre</th><th>Garnison max. (estim√©e)</th></tr></thead>
                            <tbody id="fortress-table"></tbody>
                        </table>
                    </details>

                    <details class="collapsible-section" open>
                        <summary><h3>Gestion des R√©giments</h3></summary>
                        <button onclick="construireBatimentSimple('ecole_militaire')">Construire √âcole Militaire</button>
                        
                        <details class="collapsible-section-simple" open>
                            <summary><h4>Infanterie (<span id="regiment-count-inf">0</span>)</h4></summary>
                            <table class="data-table">
                                <thead><tr><th>Nom</th><th>Type</th><th>Effectif</th><th>Localisation</th><th>Actions</th></tr></thead>
                                <tbody id="regiment-table-inf"></tbody>
                            </table>
                        </details>
                        <details class="collapsible-section-simple">
                            <summary><h4>Cavalerie (<span id="regiment-count-cav">0</span>)</h4></summary>
                            <table class="data-table">
                                <thead><tr><th>Nom</th><th>Type</th><th>Effectif</th><th>Localisation</th><th>Actions</th></tr></thead>
                                <tbody id="regiment-table-cav"></tbody>
                            </table>
                        </details>
                        <details class="collapsible-section-simple">
                            <summary><h4>Artillerie (<span id="regiment-count-art">0</span>)</h4></summary>
                            <table class="data-table">
                                <thead><tr><th>Nom</th><th>Type</th><th>Effectif</th><th>Localisation</th><th>Actions</th></tr></thead>
                                <tbody id="regiment-table-art"></tbody>
                            </table>
                        </details>
                        <details class="collapsible-section-simple">
                            <summary><h4>G√©nie & Sapeurs (<span id="regiment-count-genie">0</span>)</h4></summary>
                            <table class="data-table">
                                <thead><tr><th>Nom</th><th>Type</th><th>Effectif</th><th>Localisation</th><th>Actions</th></tr></thead>
                                <tbody id="regiment-table-genie"></tbody>
                            </table>
                        </details>
                        <details class="collapsible-section-simple">
                            <summary><h4>Garde (<span id="regiment-count-garde">0</span>)</h4></summary>
                            <table class="data-table">
                                <thead><tr><th>Nom</th><th>Type</th><th>Effectif</th><th>Localisation</th><th>Actions</th></tr></thead>
                                <tbody id="regiment-table-garde"></tbody>
                            </table>
                        </details>
                        
                        <details class="collapsible-section-simple" open>
                            <summary><h4>Garde Nationale (Milice M√©tropole)</h4></summary>
                            <p>Mobilisez une partie de votre population en tant que force de r√©serve. Ils n√©cessitent des fusils et un co√ªt d'entretien (0.15 LT/jour).</p>
                            <div class="control-group">
                                <label for="slider-garde-ratio">Taux de mobilisation (1 / <span id="garde-ratio-display">200</span> habitants)</label>
                                <input type="range" id="slider-garde-ratio" min="50" max="500" value="200" oninput="updateGardeRatio(this.value)">
                            </div>
                            
                            <h4>Statut de la Garde</h4>
                            <div class="stat-grid" style="grid-template-columns: 1fr 1fr 1fr 1fr 1fr;">
                                <div>Effectif Cible <strong id="garde-cible">0</strong></div>
                                <div>Effectif Actuel <strong id="garde-actuel">0</strong></div>
                                <div>Fusils Requis <strong id="garde-fusils" class="negative">0</strong></div>
                                <div>Bataillons (est.) <strong id="garde-bataillons">0</strong></div>
                                <div>Officiers Requis <strong id="garde-officiers-requis" class="negative">0</strong></div>
                            </div>
                            <p>Co√ªt de la Solde : <strong id="garde-cout" class="negative">0 LT/an</strong> (Calcul√© dans le budget militaire)</p>
                            <button onclick="recruterGardeNationale()">Ajuster la Garde Nationale (Recruter / D√©mobiliser)</button>
                        </details>
                        </details>

                    <details class="collapsible-section">
                        <summary><h3><span style="font-size: 0.8em;">‚öôÔ∏è</span> Doctrine & Composition des R√©giments</h3></summary>
                        <p>Ajustez la taille et l'encadrement de vos unit√©s. Cela affectera le co√ªt, le manpower et l'efficacit√©.</p>
                        
                        <h4>Infanterie (Compagnie -> Bataillon -> R√©giment)</h4>
                        <div class="action-grid-small" style="grid-template-columns: 1fr 1fr 1fr 1fr;">
                            <div class="control-group">
                                <label for="doctrine-inf-soldats">Soldats / Cie</label>
                                <input type="number" id="doctrine-inf-soldats" onchange="updateDoctrine('infanterie', 'soldats_compagnie', this.value)">
                            </div>
                            <div class="control-group">
                                <label for="doctrine-inf-sous_officiers">Sous-Off. / Cie</label>
                                <input type="number" id="doctrine-inf-sous_officiers" onchange="updateDoctrine('infanterie', 'sous_officiers_compagnie', this.value)">
                            </div>
                            <div class="control-group">
                                <label for="doctrine-inf-compagnies">Cies / Bataillon</label>
                                <input type="number" id="doctrine-inf-compagnies" onchange="updateDoctrine('infanterie', 'compagnies_bataillon', this.value)">
                            </div>
                            <div class="control-group">
                                <label for="doctrine-inf-bataillons">Bataillons / R√©giment</label>
                                <input type="number" id="doctrine-inf-bataillons" onchange="updateDoctrine('infanterie', 'bataillons_regiment', this.value)">
                            </div>
                        </div>
                        <p><strong>Total (Infanterie) :</strong> <strong id="doctrine-inf-total">...</strong> (Hommes/Sous-Officiers)</p>

                        <h4>Cavalerie (Escadron -> R√©giment)</h4>
                        <div class="action-grid-small" style="grid-template-columns: 1fr 1fr 1fr;">
                            <div class="control-group">
                                <label for="doctrine-cav-soldats">Soldats / Escadron</label>
                                <input type="number" id="doctrine-cav-soldats" onchange="updateDoctrine('cavalerie', 'soldats_escadron', this.value)">
                            </div>
                            <div class="control-group">
                                <label for="doctrine-cav-sous_officiers">Sous-Off. / Escadron</label>
                                <input type="number" id="doctrine-cav-sous_officiers" onchange="updateDoctrine('cavalerie', 'sous_officiers_escadron', this.value)">
                            </div>
                            <div class="control-group">
                                <label for="doctrine-cav-escadrons">Escadrons / R√©giment</label>
                                <input type="number" id="doctrine-cav-escadrons" onchange="updateDoctrine('cavalerie', 'escadrons_regiment', this.value)">
                            </div>
                        </div>
                        <p><strong>Total (Cavalerie) :</strong> <strong id="doctrine-cav-total">...</strong> (Cavaliers/Sous-Officiers)</p>
                        
                        <h4>Salaires des Officiers Sup√©rieurs (Terre)</h4>
                        <table class="data-table">
                            <thead><tr><th>Rang (Arm√©e)</th><th>Salaire Annuel (LT)</th></tr></thead>
                            <tbody id="army-salary-table">
                                </tbody>
                        </table>

                    </details>
                </div>
            </div>

            <div id="tab-operations" class="tab-content">
                <div class="card">
                    <h2>Op√©rations Militaires & Gestion des Arm√©es</h2>
                    <p>Organisez vos r√©giments en arm√©es et d√©placez-les sur la carte.</p>
                    
                    <details class="collapsible-section" open>
                        <summary><h3>Arm√©es Form√©es (Total: <span id="armees-count">0</span>)</h3></summary>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Nom de l'Arm√©e</th>
                                    <th>Localisation</th>
                                    <th>Effectif (R√©giments)</th>
                                    <th>Puissance (est.)</th> 
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="armees-list-table">
                                </tbody>
                        </table>
                    </details>
                    
                    <details class="collapsible-section" open>
                        <summary><h3>R√©giments en Garnison (Non assign√©s)</h3></summary>
                        <p>S√©lectionnez les r√©giments (tous dans la m√™me province) pour former une nouvelle arm√©e.</p>
                        <div class="action-grid-small" style="grid-template-columns: 2fr 1fr 1fr;">
                            <div class="control-group">
                                <label>Nom de la nouvelle arm√©e</label>
                                <input type="text" id="new-army-name" placeholder="Ex: Arm√©e du Nord">
                            </div>
                            <div class="control-group">
                                <label>Statut</label>
                                <select id="new-army-status">
                                    <option value="defense">D√©fense</option>
                                    <option value="invasion">Invasion</option>
                                </select>
                            </div>
                            <button onclick="creerArmee()">Former l'Arm√©e</button>
                        </div>
                        
                        <div id="garnison-list-container"></div>
                    </details>
                </div>
            </div>
            
            <div id="tab-diplomatie" class="tab-content">
                <div class="card">
                    
                    <details class="collapsible-section" open>
                        <summary><h3>Guerres Actives (Point #6)</h3></summary>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Conflit</th>
                                    <th>Score de Guerre</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="guerres-actives-table">
                                <tr><td colspan="3">Vous √™tes actuellement en paix.</td></tr>
                            </tbody>
                        </table>
                    </details>
                    
                    <details class="collapsible-section" open>
                        <summary><h3>Relations Diplomatiques</h3></summary>
                        <p>G√©rez vos relations avec les autres puissances.</p>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Faction</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="diplomatie-list-table">
                                </tbody>
                        </table>
                    </details>
                </div>
            </div>

            <div id="tab-marine" class="tab-content">
                <div class="card">
                    <h2>Statut de la Flotte</h2>
                    <div class="stat-grid" id="navy-summary">
                        <div>Vaisseaux de Ligne <strong id="summary-marine-ligne">0</strong></div>
                        <div>Fr√©gates & Escorte <strong id="summary-marine-fregates">0</strong></div>
                        <div>Marins (Disponibles) <strong id="summary-marine-marins">0</strong></div>
                        <div>Capacit√© Radoub <strong id="summary-marine-radoub">0</strong></div>
                    </div>
                    
                    <details class="collapsible-section" open>
                        <summary><h4>D√©tail des Co√ªts de la Marine</h4></summary>
                        <h5>Salaires (Calcul√©s)</h5>
                        <table class="data-table-simple">
                            <tbody>
                                <tr><td>Marins & Troupes</td><td id="marine-cout-marins">... LT</td></tr>
                                <tr><td>Officiers (Total)</td><td id="marine-cout-officiers">... LT</td></tr>
                            </tbody>
                        </table>
                        <h5>Co√ªts Op√©rationnels (Calcul√©s)</h5>
                        <table class="data-table-simple">
                            <tbody>
                                <tr><td>Entretien Navires & Ports</td><td id="marine-detail-entretien">... LT</td></tr>
                                <tr><td>Approvisionnement Flotte</td><td id="marine-detail-appro">... LT</td></tr>
                            </tbody>
                        </table>
                    </details>
                    <h3>Construction Navale</h3>
                    <div class="action-grid-small">
                        <div class="control-group">
                            <label>Type de Navire</label>
                            <select id="navire-type-select"></select>
                        </div>
                        <div class="control-group">
                            <label>Quantit√©</label>
                            <input type="number" id="navire-construire-nb" value="1" min="1">
                        </div>
                        <button onclick="construireNavires()">Construire Navires</button>
                    </div>

                    <details class="collapsible-section">
                        <summary><h3>Industrie & Infrastructure Navale (<span id="arsenal-count">0</span>)</h3></summary>
                        <button onclick="ouvrirModalConstruction('naval')">Construire B√¢timent Naval</button>
                        <button onclick="construireBatimentSimple('ecole-navale')">Construire √âcole Navale</button>
                        <table class="data-table">
                            <thead><tr><th>Infrastructure</th><th>Niveau/Nombre</th><th>Effet</th></tr></thead>
                            <tbody id="arsenal-table"></tbody>
                        </table>
                    </details>
                    
                    <details class="collapsible-section" open>
                        <summary><h3>Gestion de la Flotte</h3></summary>
                        <div class="action-grid-small">
                            <button onclick="flotteMassAction('arme')">Armer toute la flotte</button>
                            <button onclick="flotteMassAction('desarme')" class="btn-danger">D√©sarmer toute la flotte</button>
                        </div>
                        
                        <details class="collapsible-section-simple" open>
                            <summary><h4>Vaisseaux de Ligne (<span id="fleet-count-ligne">0</span>)</h4></summary>
                            <table class="data-table">
                                <thead><tr><th>Nom</th><th>Type</th><th>Statut</th><th>√Çge</th><th>Actions</th></tr></thead>
                                <tbody id="fleet-table-ligne"></tbody>
                            </table>
                        </details>
                        
                        <details class="collapsible-section-simple" open>
                            <summary><h4>Fr√©gates & Escorte (<span id="fleet-count-escorte">0</span>)</h4></summary>
                            <table class="data-table">
                                <thead><tr><th>Nom</th><th>Type</th><th>Statut</th><th>√Çge</th><th>Actions</th></tr></thead>
                                <tbody id="fleet-table-escorte"></tbody>
                            </table>
                        </details>
                    </details>
                </div>
            </div>

            <div id="tab-colonies" class="tab-content">
                <div class="card">
                    <h2>Statut Colonial</h2>
                    <div id="colony-summary">
                        <details class="collapsible-section-simple" open>
                            <summary>Pop. Coloniale <strong id="summary-colonie-pop">0</strong></summary>
                            <p><i>La population coloniale est r√©partie entre les villes et la "Campagne" (plantations).</i></p>
                            <table class="data-table-simple">
                                <tbody>
                                    <tr><td>Colons (Total)</td><td id="pop-colons-total">0</td></tr>
                                    <tr><td>Indig√®nes (Total)</td><td id="pop-indigenes-total">0</td></tr>
                                    <tr><td>Esclaves (Total)</td><td id="pop-esclaves-total">0</td></tr>
                                </tbody>
                            </table>
                        </details>
                        <div class="stat-grid" style="grid-template-columns: 1fr 1fr 1fr;">
                            <div>Hectares D√©velopp√©s <strong id="summary-colonie-hectares">0</strong></div>
                            <div>Terres Disponibles <strong id="summary-colonie-terres">0</strong></div>
                            <div>Milices Coloniales <strong id="summary-colonie-milice">0</strong></div>
                        </div>
                    </div>

                    <h3>Actions Coloniales Globales</h3>
                    <div class="action-grid-small">
                        <button onclick="financerExploration()">Financer Exploration</button>
                        <button onclick="entrainerMilice('coloniale')">Recruter Milice Coloniale</button>
                        <button onclick="fonderVilleColonie()">Fonder une Colonie (Hameau)</button>
                    </div>

                    <h3>Gestion de la Main d'≈ìuvre</h3>
                    <div class="action-grid-small">
                        <div class="control-group">
                            <label>Acheter Esclaves</label>
                            <input type="number" id="esclaves-input" value="1000" min="0" step="100" oninput="updateSlaveCost()">
                        </div>
                        <button onclick="acheterEsclaves()">Acheter (Co√ªt: 400k LT)</button>
                    </div>
                    
                    <details class="collapsible-section" open>
                        <summary><h3>Villes Coloniales (<span id="colony-city-count">0</span>)</h3></summary>
                        <table class="data-table">
                            <thead><tr><th>Nom</th><th>Type</th><th>Colons</th><th>Indig√®nes</th><th>Esclaves</th><th>Actions</th></tr></thead>
                            <tbody id="colony-city-table"></tbody>
                        </table>
                    </details>
                    
                    <details class="collapsible-section">
                        <summary><h3>D√©veloppement des Terres & Envoi de Colons</h3></summary>
                        <p>Les colons envoy√©s iront √† 10% dans les villes et 90% √† la campagne. Les terres d√©frich√©es iront √† la campagne.</p>
                        <div class="action-grid-small">
                            <div class="control-group">
                                <label>Envoyer Colons</label>
                                <input type="number" id="colons-input" value="100" min="0">
                            </div>
                            <div class="control-group">
                                <label>Hectares (Campagne)</label>
                                <input type="number" id="hectares-input" value="250" min="0">
                            </div>
                            <div class="control-group">
                                <label>Type de Culture</label>
                                <select id="crop-type-select">
                                    <option value="">-- Choisir --</option>
                                    <option value="sucre_kg">Sucre</option>
                                    <option value="cafe_kg">Caf√©</option>
                                    <option value="epices_kg">√âpices</option>
                                    <option value="tabac_kg">Tabac</option>
                                    <option value="coton_kg">Coton</option>
                                    <option value="indigo_kg">Indigo</option>
                                    <option value="the_kg">Th√©</option>
                                    <option value="ble_kg">Bl√©</option>
                                </select>
                            </div>
                        </div>
                        <button onclick="gererColons()">D√©velopper la Campagne</button>
                    </details>
                    
                    <details class="collapsible-section">
                        <summary><h3>Production Coloniale Totale (Villes + Campagne)</h3></summary>
                        <table class="data-table">
                            <thead><tr><th>Bien (Hectares)</th><th>Production (Kg/Pi√®ces)</th><th>Valeur</th></tr></thead>
                            <tbody id="colonial-production-table"></tbody>
                        </table>
                    </details>
                </div>
            </div>
            
            <div id="tab-commerce" class="tab-content">
                <div class="card">
                    <h2>Commerce & Flotte Priv√©e</h2>
                    <p>Le commerce est g√©r√© par le secteur priv√©. L'√âtat peut l'influencer en finan√ßant des infrastructures qui augmentent la rentabilit√© et la vitesse de construction de la flotte marchande.</p>

                    <details class="collapsible-section" open>
                        <summary><h3>Flotte Marchande Priv√©e (Actuelle)</h3></summary>
                        <p>Cette flotte se construit passivement. Votre objectif est d'acc√©l√©rer sa croissance via les infrastructures.</p>
                        <table class="data-table">
                            <thead><tr><th>Type Navire Marchand</th><th>Nombre</th><th>Puissance Commerciale</th></tr></thead>
                            <tbody id="merchant-fleet-table">
                                </tbody>
                        </table>
                    </details>

                    <details class="collapsible-section">
                        <summary><h3>March√© Mondial</h3></summary>
                        <p>Achetez ou vendez des ressources. Les prix fluctuent en fonction de l'offre et de la demande mondiale.</p>
                        <div class="action-grid-small" style="grid-template-columns: 2fr 1fr 1fr 1fr;">
                            <div class="control-group">
                                <label>Ressource</label>
                                <select id="market-resource-select" onchange="updateMarketInfo()">
                                    </select>
                            </div>
                            <div class="control-group">
                                <label>Quantit√©</label>
                                <input type="number" id="market-quantity-input" value="100" min="0" oninput="updateMarketInfo()">
                            </div>
                            <button id="market-buy-btn" onclick="acheterRessource()">Acheter (Co√ªt: ...)</button>
                            <button id="market-sell-btn" onclick="vendreRessource()">Vendre (Revenu: ...)</button>
                        </div>
                        <p id="market-info-text">Stock Actuel : ... | Prix du March√© : ... LT</p>
                    </details>
                    
                    <details class="collapsible-section" open>
                        <summary><h3>Infrastructures Commerciales</h3></summary>
                        <p>Construisez des b√¢timents pour soutenir vos marchands.</p>
                        
                        <button onclick="ouvrirModalConstruction('commerce_all')">Construire Infrastructure Commerciale</button>
                        <h4>B√¢timents Actifs</h4>
                        <table class="data-table">
                            <thead><tr><th>Nom</th><th>Quantit√©</th><th>Effet Principal</th></tr></thead>
                            <tbody id="commerce-buildings-table">
                                </tbody>
                        </table>
                    </details>
                    
                    <details class="collapsible-section" open>
                        <summary><h3>Politiques Commerciales</h3></summary>
                        <p>Actions uniques pour dynamiser votre commerce national.</p>
                        <button id="btn-fonder-compagnie" onclick="fonderCompagnieMarchande()">Fonder une Compagnie Marchande (Co√ªt: 5 000 000 LT)</button>
                        <p style="font-size: 0.9em; color: #666;"><i>(Cette action ne peut √™tre entreprise qu'une seule fois et d√©bloque des bonus commerciaux passifs.)</i></p>
                    </details>
                </div>
            </div>

        </div>
    </main>

    <footer>
        <div class="card">
            <h2>Rapport Annuel (Log)</h2>
            <div id="game-log">
                <p>D√©marrage du syst√®me...</p>
            </div>
        </div>
    </footer>

    <script src="kriegspiel_engine.js"></script>
</body>
</html>